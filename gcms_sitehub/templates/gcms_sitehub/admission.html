{% extends 'gcms_sitehub/base.html' %}
{% load static %}

{% block title %}Event{% endblock %}

{% block content %}


      <!-- Header Top END ==== -->
<!-- Hero Section -->
<div class="page-banner ovbl-dark" style="background-image: url({% static 'assets/images/slider/slide1.jpg' %}); height: 80vh;">
  <div class="container">
    <div class="page-banner-entry text-center text-white">
      <h1 class="display-4" style="margin-top: 52px;">Admission</h1>
      <p class="lead">Start your journey with us</p>
    </div>
  </div>
</div>
<!-- Admission Process Section -->
<section class="admission-process py-5 bg-light text-dark">
  <div class="container">
    <!-- Section Title -->
    <h2 class="section-title text-center mb-5">
      <i class="fas fa-stream me-2 text-primary"></i> Admission Process
    </h2>

    <!-- Steps -->
    <div class="row g-4 justify-content-center">
      {% for step in steps %}
      <div class="col-md-6 col-lg-4">
        <div class="process-step bg-white text-center p-4 border rounded-4 shadow-sm h-100 transition">
          <!-- Icon -->
          <div class="step-icon mb-3">
            <i class="{{ step.icon_class }} fa-3x text-primary"></i>
          </div>
          <!-- Title and Description -->
          <h5 class="fw-bold mb-2">{{ forloop.counter }}. {{ step.title }}</h5>
          <p class="text-muted mb-0">{{ step.description }}</p>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</section>

<!-- Fee Structure Section -->
<section class="fees-section py-5 bg-white">
  <div class="container">
    <h2 class="section-title text-center mb-4">
      <i class="fas fa-coins text-success me-2"></i> Fee Structure by Department
    </h2>
    <p class="text-center text-muted mb-5">
      Annual tuition fees for undergraduate programs across our departments.
    </p>

    <div class="table-responsive shadow-sm rounded-4 overflow-hidden">
      <table class="table table-bordered table-hover align-middle bg-white">
        <thead class="text-white" style="background-color: #0d6efd;">
          <tr>
            <th scope="col"><i class="fas fa-building me-2"></i>Department</th>
            <th scope="col"><i class="fas fa-book-open me-2"></i>Program</th>
            <th scope="col"><i class="fas fa-money-bill me-2"></i>Annual Fee (PKR)</th>
            <th scope="col"><i class="fas fa-hourglass-half me-2"></i>Duration</th>
          </tr>
        </thead>
        <tbody>
          {% for fee in fees %}
          <tr>
            <td><span class="badge bg-success text-dark fw-semibold">{{ fee.get_department_display }}</span></td>
            <td>{{ fee.program }}</td>
            <td class="text-secondary fw-bold">{{ fee.fee_range }}</td>
            <td class="">{{ fee.duration }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="alert alert-info mt-4 rounded-3 shadow-sm">
      <h5 class="mb-3"><i class="fas fa-info-circle me-2"></i> Additional Information</h5>
      <ul class="mb-0">
        <li>Fee structure may vary slightly between campuses</li>
        <li>Hostel charges extra: PKR 10,000 – 20,000 per year</li>
        <li>Scholarships available for meritorious students</li>
      </ul>
    </div>
  </div>
</section>

<!-- Application Download Section -->
<section class="application-section py-5 bg-light">
  <div class="container text-center">
    <h2 class="fw-bold mb-3">
      <i class="fas fa-file-signature text-danger me-2"></i>Begin Your Academic Journey Today
    </h2>
    <p class="lead text-muted mb-4">
      Applications for <strong>{{ application.intake_season }}</strong> intake are now open.
    </p>

    {% if application.form_file %}
    <a class="btn btn-success btn-lg shadow-sm me-3" href="{{ application.form_file.url }}">
      <i class="fas fa-download me-2"></i>Download Admission Form
    </a>
    {% else %}
    <p class="text-danger">Admission form not available at the moment.</p>
    {% endif %}

    <button type="button" class="btn btn-primary btn-lg shadow-sm" data-bs-toggle="modal" data-bs-target="#applyOnlineModal">
      <i class="fas fa-edit me-2"></i>Apply Online
    </button>
  </div>
</section>


<!-- Apply Online Modal -->
<div class="modal fade" id="applyOnlineModal" tabindex="-1" aria-labelledby="applyOnlineModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <form method="post" action="{% url 'apply_online' %}">
        {% csrf_token %}
        <div class="modal-header">
          <h5 class="modal-title" id="applyOnlineModalLabel">Online Registration Form</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">

          <div class="mb-3">
            <label for="fullName" class="form-label">Full Name</label>
            <input type="text" class="form-control" id="fullName" name="full_name" required>
          </div>

          <div class="mb-3">
            <label for="email" class="form-label">Email Address</label>
            <input type="email" class="form-control" id="email" name="email" required>
          </div>

          <div class="mb-3">
            <label for="phone" class="form-label">Phone Number</label>
            <input type="text" class="form-control" id="phone" name="phone" required>
          </div>

          <div class="mb-3">
            <label for="address" class="form-label">Address</label>
            <textarea class="form-control" id="address" name="address" rows="2" required>Swat, Khyber Pakhtunkhwa</textarea>
          </div>

          <div class="mb-3">
            <label for="program" class="form-label">Program Applying For</label>
            <select class="form-select" id="program" name="program" required>
              <option value="ICS">ICS (Computer Science)</option>
              <option value="Computer Science">Computer Science</option>
              <option value="I.Com">I.Com (Commerce)</option>
              <option value="D.Com">D.Com (Diploma in Commerce)</option>
              <option value="DIT">DIT (Diploma in IT)</option>
              <option value="Business Admin">Business Administration</option>
              <option value="FSc Pre-Engineering">FSc Pre-Engineering</option>
              <option value="Commerce">Commerce</option>
              <option value="Other">Other</option>
            </select>
          </div>

          <div class="mb-3">
            <label for="previousInstitute" class="form-label">Previous School/College</label>
            <input type="text" class="form-control" id="previousInstitute" name="previous_institute" value="Government School Swat" required>
          </div>

          <div class="mb-3">
            <label for="yearCompleted" class="form-label">Year Completed</label>
            <input type="number" class="form-control" id="yearCompleted" name="year_completed" value="2024" min="2000" max="2099" required>
          </div>

        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-success">Submit Application</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Success/Error Alert Box -->
{% if messages %}
<div class="container mt-3">
  {% for message in messages %}
    <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
      {{ message }}
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
  {% endfor %}
</div>
{% endif %}
</div>



  <!-- Revolution Slider Setup -->
  <script>
    jQuery(document).ready(function () {
      var ttrevapi;
      var tpj = jQuery;
      if (tpj("#rev_slider_486_1").revolution == undefined) {
        revslider_showDoubleJqueryError("#rev_slider_486_1");
      } else {
        ttrevapi = tpj("#rev_slider_486_1").show().revolution({
          sliderType: "standard",
          jsFileLocation: "{% static 'assets/vendors/revolution/js/' %}",
          sliderLayout: "fullwidth",
          dottedOverlay: "none",
          delay: 9000,
          navigation: {
            keyboardNavigation: "on",
            mouseScrollNavigation: "off",
            touch: {
              touchenabled: "on",
              swipe_threshold: 75,
              swipe_direction: "horizontal",
            },
            arrows: {
              style: "uranus",
              enable: true,
              hide_onmobile: false,
            },
          },
          viewPort: {
            enable: true,
            outof: "pause",
            visible_area: "80%",
          },
          responsiveLevels: [1240, 1024, 778, 480],
          visibilityLevels: [1240, 1024, 778, 480],
          gridwidth: [1240, 1024, 778, 480],
          gridheight: [768, 600, 600, 600],
          lazyType: "none",
          parallax: {
            type: "scroll",
            speed: 400,
            levels: [5, 10, 15, 20, 25, 30, 35, 40, 45, 50],
          },
        });
      }
    });
  </script>

  
<!-- JavaScript -->
<script>
document.getElementById('onlineApplicationForm').addEventListener('submit', function(e) {
  e.preventDefault();

  const form = e.target;
  const formData = new FormData(form);
  const csrfToken = form.querySelector('[name="csrfmiddlewaretoken"]').value;

  fetch("{% url 'apply_online' %}", {
    method: 'POST',
    headers: {
      'X-CSRFToken': csrfToken
    },
    body: formData
  })
  .then(response => response.json())
  .then(data => {
    if (data.success) {
      // Show success alert
      alert("✅ Application submitted! Redirecting to HED site...");

      // Optional: Close modal
      const modal = bootstrap.Modal.getInstance(document.getElementById('applyOnlineModal'));
      modal.hide();

      // Redirect to HED in new tab
      window.open("https://admission.hed.gkp.pk/", "_blank");

      // Optional: Reset the form
      form.reset();
    } else {
      alert("❌ Error: " + data.message);
    }
  });
});
</script>
 {% endblock %}